<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/about.css" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
      crossorigin="anonymous"
    />
    <script
      src="https://kit.fontawesome.com/e61ba0b5d3.js"
      crossorigin="anonymous"
    ></script>
    <link rel="icon" href="../assets/images/hasanah.png" type="image/x-icon" />
    <title>Hasanah</title>
    <style>
      .div-container {
      border: 1px solid #ddd;
      border-radius: 10px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      padding: 20px;
      margin-bottom: 20px;
      background-color: #fff;
      max-width: 400px;
      margin: 0 auto;
    }
    .imgg-design {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 10px;
      margin-bottom: 15px;
    }
    .border-amount {
      border: 1px solid #ddd;
      border-radius: 5px;
      padding: 5px 10px;
      width: 100px;
      margin-left: 10px;
    }
    .bg-color {
      background-color: #0d715e;
      color: #fff;
      border: none;
      border-radius: 5px;
      padding: 5px 15px;
    }
    .bg-color:hover {
      background-color: rgb(17, 71, 29);
    }
    .progress {
      height: 20px;
      border-radius: 10px;
      margin-bottom: 10px;
      background-color: #e9ecef;
    }
    .progress-bar {
      background-color: #28a745;
      border-radius: 10px;
    }
    .login{
        background-color: #0d715e   !important;
        color: #fff  !important;
        border: none;
        border-radius: 5px;
        padding: 5px 15px;
      }
      .login:hover{
        background-color: rgb(17, 71, 29) !important;
        color: white !important;
      }
  </style>
  </head>

  <body>
    <!-- NAV -->
    <nav class="navbar navbar-expand-lg navbar-light bg-white sticky-top">
            <div class="container">
              <img
                class="logo"
                width="50px"
                src="../assets/images/logo.png"
                alt="logo"
              />
              <button
                class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#navbarNav"
                aria-controls="navbarNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse text-center gap-5" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                  <li class="nav-item">
                    <a class="nav-link" href="../index.html">الرئيسية</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="./about.html">من نحن</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="./donations.html">التبرعات</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="./activities.html">الأنشطة</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="./articles.html">المقالات</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" href="./contact.html">تواصل معنا</a>
                  </li>
                </ul>
      
                <div class="nav-containor-button justify-content-center">
                  <div class="nav-item">
                    <a class="nav-link jobColor d-none" href="./userPage.html"
                      >الصفحة الشخصية</a
                    >
                  </div>
                  <button
                    class="nav-button user-btn"
                    onclick="window.location.href='./register.html'"
                  >
                    تسجيل الدخول
                  </button>
                  <button class="nav-button logout-btn d-none">تسجيل الخروج</button>
                </div>
              </div>
            </div>
        </nav>

    
    <div class="container my-5">
      <h1 class="text-center mb-4">تبرع الآن</h1>
      <div class="row donates">
        
          
        </div>
      </div>
    </div>
    
    
    
    <!-- Footer -->
    <footer>
      <div class="footer-top text-center">
        <div class="container">
          <div class="row justify-content-center">
            <div class="col-lg-6 text-center">
              <img
                class="img-footer"
                src="../assets/images/logo.png"
                alt="شعار حسنه"
              />
              <p>
                مع <strong>حسنه</strong>، كن جزءًا من التغيير! نحن نساعد في
                تمكين الأفراد والمجتمعات من خلال التبرعات والأنشطة الخيرية. ساهم
                اليوم واصنع فرقًا حقيقيًا في حياة الآخرين.
              </p>
            </div>
          </div>
        </div>
      </div>
      <div class="footer-bottom text-center">
        <p class="mb-0">حقوق النشر &copy; 2025 حسنه. جميع الحقوق محفوظة</p>
        توزيع بواسطة <a href="https://Hasanah.com">حسنه</a>
      </div>
    </footer>
    
    
    <!-- Donation Success Modal -->
<div class="modal fade" id="donationSuccessModal" tabindex="-1" aria-labelledby="modalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="modalLabel">نجاح التبرع</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="إغلاق"></button>
      </div>
      <div class="modal-body">
        <p id="donationMessage"></p>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-bs-dismiss="modal">حسنًا</button>
      </div>
    </div>
  </div>
</div>

    
    <script>
  document.addEventListener("DOMContentLoaded", function () {
  fetch("../server/donations.json")
    .then(response => {
      if (!response.ok) {
        throw new Error(`HTTP error! Status: ${response.status}`);
      }
      return response.json();
    })
    .then(data => {
      console.log(data.donations);

      const donatesContainer = document.querySelector(".donates");

      data.donations.forEach(donate => {
        const card = document.createElement("div");
        card.classList.add("col-md-6", "col-lg-4", "mx-auto");

        card.innerHTML = `<form>
          <div class="div-container d-flex flex-column justify-content-center align-items-center mb-3 p-2">
            <img class="imgg-design" src="${donate.img}" alt="صورة المشروع">
            <div class="text-center">
              <h3 class="p-1">${donate.title}</h3>
              <p class="p-1">${donate.description}</p>
            </div>
            <div class="w-100">
              <p><strong>الهدف:</strong> ${donate.targetAmount} دينار</p>
              <p><strong>المجموع الحالي:</strong> ${donate.currentAmount} دينار </p>
            </div>
            <div class="user d-flex align-items-center mt-3 w-100">
              <input title="amount" required type="number" class="ps-3 btn border-amount w-100 donation-input" placeholder="المبلغ" min="1">
              <input type="submit" class="btn bg-color donate-btn" value="تبرع">
            </div>
            <a href="./register.html" class="login btn bg-color ">تبرع</a>
          </div>
          </form>
        `;

        // Append to container
        donatesContainer.appendChild(card);
      });
    })
    .then(() => {
            
            function checkUserLoggedIn() {
                        return localStorage.getItem("user") !== null;
                      }
                      const userActions = document.querySelectorAll(".user");
                      const loginActions = document.querySelectorAll(".login");
                      userActions.forEach(action => {
                        if (!checkUserLoggedIn()) {
                          action.classList.add("d-none");
                        } else {
                          action.classList.remove("d-none");
                        }
                      });
                      loginActions.forEach(action => {
                        if (checkUserLoggedIn()) {
                          action.classList.add("d-none");
                        } else {
                          action.classList.remove("d-none");
                        }
                      });
      })
    .catch(error => console.error("Error loading donations:", error));

  // Event Delegation - Handle Clicks on dynamically added buttons
  document.querySelector(".donates").addEventListener("click", function (event) {
  if (event.target.classList.contains("donate-btn")) {
    event.preventDefault();
    const container = event.target.closest(".div-container");
    const title = container.querySelector("h3").textContent.trim();
    const amountInput = container.querySelector(".donation-input");
    const amount = parseFloat(amountInput.value);


    let userData = JSON.parse(localStorage.getItem("user")) || {};
    userData.donationHistory = userData.donationHistory || [];

    userData.donationHistory.push({ title, amount });
    localStorage.setItem("user", JSON.stringify(userData));

    amountInput.value = "";

    // Update modal message
    document.getElementById("donationMessage").textContent = `تمت إضافة تبرع ${amount} دينار لمشروع "${title}" بنجاح!`;

    // Show Bootstrap Modal
    let donationModal = new bootstrap.Modal(document.getElementById("donationSuccessModal"));
    donationModal.show();
  }
});


});



  


  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
    </script>
    <script src="../js/navBar.js"></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
